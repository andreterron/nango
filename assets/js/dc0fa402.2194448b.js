"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1330],{3905:(t,e,a)=>{a.d(e,{Zo:()=>p,kt:()=>h});var n=a(7294);function o(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){o(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function s(t,e){if(null==t)return{};var a,n,o=function(t,e){if(null==t)return{};var a,n,o={},r=Object.keys(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||(o[a]=t[a]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(o[a]=t[a])}return o}var l=n.createContext({}),u=function(t){var e=n.useContext(l),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},p=function(t){var e=u(t.components);return n.createElement(l.Provider,{value:e},t.children)},c={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},m=n.forwardRef((function(t,e){var a=t.components,o=t.mdxType,r=t.originalType,l=t.parentName,p=s(t,["components","mdxType","originalType","parentName"]),m=u(a),h=o,d=m["".concat(l,".").concat(h)]||m[h]||c[h]||r;return a?n.createElement(d,i(i({ref:e},p),{},{components:a})):n.createElement(d,i({ref:e},p))}));function h(t,e){var a=arguments,o=e&&e.mdxType;if("string"==typeof t||o){var r=a.length,i=new Array(r);i[0]=m;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=t,s.mdxType="string"==typeof t?t:o,i[1]=s;for(var u=2;u<r;u++)i[u]=a[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},6334:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>u});var n=a(7462),o=(a(7294),a(3905));const r={sidebar_label:"MS Teams"},i="Blueprint: Microsoft Teams",s={unversionedId:"blueprint-catalog/blueprint-microsoft-teams",id:"blueprint-catalog/blueprint-microsoft-teams",title:"Blueprint: Microsoft Teams",description:"This blueprint of Nango for the MS Teams API makes it very easy to work with the MS Teams REST API and automates common tasks such as OAuth 2 authentication, requests authorization, logging, rate-limit handling, error handling and automatic retries.",source:"@site/docs/blueprint-catalog/blueprint-microsoft-teams.md",sourceDirName:"blueprint-catalog",slug:"/blueprint-catalog/blueprint-microsoft-teams",permalink:"/blueprint-catalog/blueprint-microsoft-teams",draft:!1,editUrl:"https://github.com/nangohq/nango/tree/main/docs/docs/blueprint-catalog/blueprint-microsoft-teams.md",tags:[],version:"current",frontMatter:{sidebar_label:"MS Teams"},sidebar:"docsSidebar",previous:{title:"Lever",permalink:"/blueprint-catalog/blueprint-lever"},next:{title:"Notion",permalink:"/blueprint-catalog/blueprint-notion"}},l={},u=[{value:"How to use it",id:"how-to-use-it",level:2},{value:"Coverage",id:"coverage",level:3},{value:"MS Teams API gotchas &amp; learnings",id:"gotchas",level:2},{value:"Action Blueprints (WIP)",id:"action-blueprints-wip",level:2}],p={toc:u};function c(t){let{components:e,...a}=t;return(0,o.kt)("wrapper",(0,n.Z)({},p,a,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"blueprint-microsoft-teams"},"Blueprint: Microsoft Teams"),(0,o.kt)("p",null,"This blueprint of Nango for the MS Teams API makes it very easy to work with the MS Teams REST API and automates common tasks such as OAuth 2 authentication, requests authorization, logging, rate-limit handling, error handling and automatic retries."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/teams-concept-overview"},"MS Teams API Docs"),"  |  ",(0,o.kt)("a",{parentName:"p",href:"#gotchas"},"API gotchas & learnings")),(0,o.kt)("p",null,"Last updated: 10.08.2022"),(0,o.kt)("h2",{id:"how-to-use-it"},"How to use it"),(0,o.kt)("p",null,"To create your own integration based on the MS Teams blueprint add this to your ",(0,o.kt)("inlineCode",{parentName:"p"},"integrations.yaml")," file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yaml",metastring:"title=integrations.yaml",title:"integrations.yaml"},"    ms-teams:\n        extends_blueprint: ms-teams:v0\n\n        oauth_client_id: '<YOUR MS TEAMS CLIENT ID>' # Make sure to quote it so YAML parses it as a string\n        oauth_client_secret: ${MS_TEAMS_CLIENT_SECRET}\n        oauth_scopes:\n            - offline_access     # Most likely you want this scope, see note below\n            - the scopes\n            - you need\n")),(0,o.kt)("p",null,"The oauth_ parameters are optional if you are not using Nango's builtin OAuth2 feature and the access token refresh."),(0,o.kt)("p",null,"If you do not request ",(0,o.kt)("inlineCode",{parentName:"p"},"offline_access")," the access token will expire after 65mins and Nango will not be able to refresh it (the user will have to re-authorize your app with the OAuth flow)."),(0,o.kt)("h3",{id:"coverage"},"Coverage"),(0,o.kt)("p",null,"Blueprint ",(0,o.kt)("inlineCode",{parentName:"p"},"v0")," covers MS Teams OAuth 2 V2 and the V1 REST API."),(0,o.kt)("p",null,"The base URL for API calls is set to ",(0,o.kt)("inlineCode",{parentName:"p"},"https://graph.microsoft.com/v1.0/")),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Nango Feature"),(0,o.kt)("th",{parentName:"tr",align:null},"Supported Status"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Builtin OAuth2 authentication"),(0,o.kt)("td",{parentName:"tr",align:null},"\u2705")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Automatic token refresh"),(0,o.kt)("td",{parentName:"tr",align:null},"\u2705")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Rate limit detection"),(0,o.kt)("td",{parentName:"tr",align:null},"\u2705")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Retries on timeout"),(0,o.kt)("td",{parentName:"tr",align:null},"\u2705")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Use any endpoint of the MS Teams REST API"),(0,o.kt)("td",{parentName:"tr",align:null},"\u2705")))),(0,o.kt)("h2",{id:"gotchas"},"MS Teams API gotchas & learnings"),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"These are community contributed field notes about working with this API. We hope they help you!")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"This Blueprint builds on the Microsoft Graph API. Integrating with Teams is a common use case for this, but the API also supports many other Microsoft services which you can all access with this Blueprint."),(0,o.kt)("li",{parentName:"ul"},"To access the Graph API you need to ",(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/graph/auth-register-app-v2"},"register your application")," in the Azure Portal's Active Directory section. Weirdly enough Microsoft will let you access the Azure portal even if your Microsoft account has never signed up for Azure before, but will then throw access errors when you try to access the Active Directory part. If you encounter this make sure you actually signed up for Azure first."),(0,o.kt)("li",{parentName:"ul"},"To develop and test Microsoft Teams related integrations you will need...access to MS Teams, which is only possible with a Microsoft Business account. You can get this for free by ",(0,o.kt)("a",{parentName:"li",href:"https://developer.microsoft.com/en-us/microsoft-365/dev-program"},"joining the MS 365 Developer program"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"If you want to build a Teams notifications integration:")," You would think posting as a bot to Microsoft Teams is easy. Here is what we found: Whilst the Graph API does support getting credentials for your application, so you can act in the name of your application and not as any specific user, the MS Teams part of the API does not support this functionality for posting messages to a channel. This means that your app can not post messages to a channel in its own name (like you would as a Slack bot). You have two options:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"You can post messages in the name of any MS Teams user who has authenticated your integration (whilst not the cleanest, this is by far the easiest solution for both you and your users). For an example of this check out the Actions listed below."),(0,o.kt)("li",{parentName:"ul"},"You can create an ",(0,o.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/microsoftteams/platform/bots/what-are-bots"},"MS Teams bot app"),". Note that this is not a REST API, instead you build & package an application (as in code & assets), deploy it to Microsoft and list it in the MS Teams App Store (which also requires Microsoft approval). Your users then first need to install your app into their Teams account from the App Store and then authorize it to get access to a channel. Once this is done you can trigger the packaged bot with an HTTP request from your server. Check the Microsoft docs for tutorials on this.")))),(0,o.kt)("admonition",{title:"Share your experience",type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Learned something about working with the MS Teams API that you want to share with other developers? ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/NangoHQ/nango/edit/main/docs/docs/blueprint-catalog/blueprint-microsoft-teams.md"},"Add it to this page")," (it is just a markdown file) and send us a pull request. Thanks so much!")),(0,o.kt)("h2",{id:"action-blueprints-wip"},"Action Blueprints (WIP)"),(0,o.kt)("p",null,"Find these on our ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/NangoHQ/nango/tree/main/nango-integrations/ms-teams"},"Github"),", more coming soon."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Action"),(0,o.kt)("th",{parentName:"tr",align:null},"Status"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"List all channels of all teams of a user"),(0,o.kt)("td",{parentName:"tr",align:null},"\u2705")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},"Post message to channel"),(0,o.kt)("td",{parentName:"tr",align:null},"\u2705")))))}c.isMDXComponent=!0}}]);