"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[939],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>y});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(n),y=i,h=d["".concat(p,".").concat(y)]||d[y]||u[y]||a;return n?r.createElement(h,o(o({ref:t},c),{},{components:n})):r.createElement(h,o({ref:t},c))}));function y(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var s=2;s<a;s++)o[s]=n[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9281:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var r=n(7462),i=(n(7294),n(3905));const a={},o="Securing Your Instance",l={unversionedId:"pizzly/pizzly-security",id:"pizzly/pizzly-security",title:"Securing Your Instance",description:"Protecting developer & user credentials",source:"@site/docs/pizzly/pizzly-security.md",sourceDirName:"pizzly",slug:"/pizzly/pizzly-security",permalink:"/pizzly/pizzly-security",draft:!1,editUrl:"https://github.com/nangohq/nango/tree/main/docs/docs/pizzly/pizzly-security.md",tags:[],version:"current",frontMatter:{},sidebar:"pizzly",previous:{title:"Getting started",permalink:"/pizzly/getting-started"},next:{title:"Storage & Logs",permalink:"/pizzly/pizzly-storage"}},p={},s=[{value:"Protecting developer &amp; user credentials",id:"protecting-developer--user-credentials",level:2},{value:"CLI requests",id:"cli-requests",level:3},{value:"Node SDK",id:"node-sdk",level:3},{value:"REST API",id:"rest-api",level:3},{value:"Publishable key for frontend OAuth flow",id:"publishable-key-for-frontend-oauth-flow",level:2}],c={toc:s};function u(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"securing-your-instance"},"Securing Your Instance"),(0,i.kt)("h2",{id:"protecting-developer--user-credentials"},"Protecting developer & user credentials"),(0,i.kt)("p",null,"For endpoints related to configuring providers and fetching user credentials, Pizzly uses ",(0,i.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Basic_access_authentication"},"Basic Auth"),"."),(0,i.kt)("p",null,"To activate Basic Auth, generate an API key (e.g. ",(0,i.kt)("a",{parentName:"p",href:"https://codepen.io/corenominal/pen/rxOmMJ"},"here"),") and add it to the ",(0,i.kt)("inlineCode",{parentName:"p"},"PIZZLY_SECRET_KEY")," environment variable (in the ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file at the root of the Pizzly folder)."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"This API key should be kept secret at all time and never committed to git. Compromising the API key would compromise your developer and user credentials stored with Pizzly.")),(0,i.kt)("p",null,"Once you redeploy Pizzly, it will expect this secret API key for any sensitive request. "),(0,i.kt)("h3",{id:"cli-requests"},"CLI requests"),(0,i.kt)("p",null,"Add the ",(0,i.kt)("inlineCode",{parentName:"p"},"PIZZLY_SECRET_KEY")," as an environment variable for your own environmnent, using your ",(0,i.kt)("inlineCode",{parentName:"p"},".bashrc")," or ",(0,i.kt)("inlineCode",{parentName:"p"},".zshrc")," file."),(0,i.kt)("h3",{id:"node-sdk"},"Node SDK"),(0,i.kt)("p",null,"When initializing the ",(0,i.kt)("inlineCode",{parentName:"p"},"Pizzly")," object, pass in the API key in the ",(0,i.kt)("inlineCode",{parentName:"p"},"secretKey")," parameter."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { Pizzly } from '@nangohq/pizzly-node'\n\n// Tell Pizzly where to find your Pizzly server + the secret API key.\nlet pizzly = new Pizzly('http://localhost:3003', apiKey);\n")),(0,i.kt)("h3",{id:"rest-api"},"REST API"),(0,i.kt)("p",null,"Add a Basic ",(0,i.kt)("inlineCode",{parentName:"p"},"Authorization")," header to your requests. To generate the header value: "),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Append the character ",(0,i.kt)("inlineCode",{parentName:"li"},":")," to your secret API key"),(0,i.kt)("li",{parentName:"ol"},"Encode this (",(0,i.kt)("inlineCode",{parentName:"li"},"[SECRET-API-KEY] + ':'"),") in Base 64"),(0,i.kt)("li",{parentName:"ol"},"The final header value should be ",(0,i.kt)("inlineCode",{parentName:"li"},"Basic [ENCODED-VALUE]"))),(0,i.kt)("p",null,"In Javascript, setting the authorization header looks like this: "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},"headers['Authorization'] = 'Basic ' + Buffer.from(process.env['PIZZLY_SECRET_KEY'] + ':').toString('base64');\n")),(0,i.kt)("h2",{id:"publishable-key-for-frontend-oauth-flow"},"Publishable key for frontend OAuth flow"),(0,i.kt)("p",null,"Additionally, you can use a publishable key to initiate the OAuth flow from Pizzly's frontend client. This key is not secret as it is embedded in your frontend, it is just a precaution measure."),(0,i.kt)("p",null,"Generate another API key (e.g. ",(0,i.kt)("a",{parentName:"p",href:"https://codepen.io/corenominal/pen/rxOmMJ"},"here"),") and add it to the ",(0,i.kt)("inlineCode",{parentName:"p"},"PIZZLY_PUBLISHABLE_KEY")," environment variable (in the ",(0,i.kt)("inlineCode",{parentName:"p"},".env")," file at the root of the Pizzly folder)."),(0,i.kt)("p",null,"Once you redeploy Pizzly, it will expect this publishable key for initiating OAuth flows from the frontend client. "),(0,i.kt)("p",null,"In your frontend code, you should now initiate the ",(0,i.kt)("inlineCode",{parentName:"p"},"Pizzly")," object with the publishable key as additional parameter: "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"var pizzly = new Pizzly('http://localhost:3003', publishableKey);\n")))}u.isMDXComponent=!0}}]);