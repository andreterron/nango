"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[182],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>h});var o=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var l=o.createContext({}),c=function(e){var n=o.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=c(e.components);return o.createElement(l.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},d=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(t),h=a,g=d["".concat(l,".").concat(h)]||d[h]||p[h]||r;return t?o.createElement(g,i(i({ref:n},u),{},{components:t})):o.createElement(g,i({ref:n},u))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,i=new Array(r);i[0]=d;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<r;c++)i[c]=t[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}d.displayName="MDXCreateElement"},210:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var o=t(7462),a=(t(7294),t(3905));const r={sidebar_label:"node-client reference",sidebar_position:3},i="Nango node.js client reference",s={unversionedId:"reference/node-client-reference",id:"reference/node-client-reference",title:"Nango node.js client reference",description:"This is the reference for the Nango node.js client SDK, which we call node-client and is published on npm as @nangohq/node-client.",source:"@site/docs/reference/node-client-reference.md",sourceDirName:"reference",slug:"/reference/node-client-reference",permalink:"/reference/node-client-reference",draft:!1,editUrl:"https://github.com/nangohq/nango/tree/main/docs/docs/reference/node-client-reference.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_label:"node-client reference",sidebar_position:3},sidebar:"docsSidebar",previous:{title:"NangoAction Reference",permalink:"/reference/nango-action-reference"}},l={},c=[{value:"Nango class",id:"nango-class",level:2},{value:"connect method",id:"connect-method",level:2},{value:"registerConnection method",id:"registerconnection-method",level:2},{value:"triggerAction method",id:"triggerAction",level:2},{value:"close method",id:"close-method",level:2},{value:"NangoMessageHandlerResult object",id:"nangoMessageHandlerResult",level:2}],u={toc:c};function p(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,o.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"nango-nodejs-client-reference"},"Nango node.js client reference"),(0,a.kt)("p",null,"This is the reference for the Nango node.js client SDK, which we call node-client and is published on npm as ",(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@nangohq/node-client"},"@nangohq/node-client"),"."),(0,a.kt)("p",null,"Other client SDKs are planned, but currently the node.js client is the only officially supported client of Nango."),(0,a.kt)("p",null,"It is written in TypeScript and includes types in its npm package for direct use in a TypeScript project. Of course you can also use it in any JavaScript based project that supports ES6. Our node-client supports both ES modules based imports and commonJS type requires."),(0,a.kt)("p",null,"You can find a full example of using the node-client in our quickstart example here: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/NangoHQ/nango/blob/main/examples/quickstart/run-quickstart.js"},(0,a.kt)("inlineCode",{parentName:"a"},"run-quickstart.js")," source code")),(0,a.kt)("p",null,"If you want to go even deeper, the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/NangoHQ/nango/tree/main/packages/node-client"},"full source code of node-client")," is available in our GitHub repo (check the ",(0,a.kt)("inlineCode",{parentName:"p"},"lib")," folder for the source files)."),(0,a.kt)("h2",{id:"nango-class"},"Nango class"),(0,a.kt)("p",null,"You use the node-client by importing the Nango class into your module:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import Nango from '@nangohq/node-client'\n")),(0,a.kt)("p",null,"When you instantiate Nango you need to pass in the connection details for the rabbitMQ instance that runs with the server. "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"nango = new Nango('localhost', 5672);\n")),(0,a.kt)("p",null,"If you use our default local development setups, you can omit the parameters which will default to ",(0,a.kt)("inlineCode",{parentName:"p"},"host='localhost'")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"port='5672'"),". The previous line can be simplified to:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"let nango = new Nango(); // This works if you use our default local development setup\n")),(0,a.kt)("h2",{id:"connect-method"},"connect method"),(0,a.kt)("p",null,"Once you have created an instance of the Nango class you should tell it to connect to rabbitMQ."),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"connect")," method returns a promise that gets resolved when the connection was successful:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"nango.connect()\n.then(() => {\n    // Connection was successfull\n})\n.catch((error) => {\n    // There was an error connecting\n});\n\n// Or more concise if you expect the connection to succeed\nawait nango.connect();\n")),(0,a.kt)("p",null,"After connect has succeeded you Nango client is ready to start sending commands to the server. If you send commands before ",(0,a.kt)("inlineCode",{parentName:"p"},"connect")," has succeeded you may get exceptions and messages will be lost."),(0,a.kt)("h2",{id:"registerconnection-method"},"registerConnection method"),(0,a.kt)("p",null,"You use the ",(0,a.kt)("inlineCode",{parentName:"p"},"registerConnection")," method to create a new connection object on the server. If you are not familiar with the concept of a connection in Nango please check the ",(0,a.kt)("a",{parentName:"p",href:"/understand-nango/framework-overview"},"Framework Overview"),"."),(0,a.kt)("p",null,"You must register a connection for the (user id, integration) pair before you can trigger an action for it."),(0,a.kt)("p",null,"The registerConnection method takes a number of parameters:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"public async registerConnection(\n        integration: string,\n        userId: string,\n        oAuthAccessToken: string,\n        additionalConfig: Record<string, unknown>\n): Promise<NangoMessageHandlerResult>\n")),(0,a.kt)("p",null,"Let's briefly look at each one:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"integration")," is the name of the integration for which you are registering the connection. This must match 1:1 with the name of the integration in the ",(0,a.kt)("inlineCode",{parentName:"li"},"integrations.yaml")," file"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"userId")," is the id of the user in your application that is setting the connection up. This could be any id, what you use is up to you and your application's use case (e.g. some integrations may be per account, so you could also send an account id instead)."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"oAuthAccessToken")," is the access token associated with this user that will be used by Nango to authenticate API calls"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"additionalConfig")," is an optional parameter you can use to store additional information along with this connection. This information will be available to you again in your action code. You can use it to store user-specific configuration of your integration such as e.g. a Slack channel id to post messages to, a mapping of a user's custom fields to your data model or similar configurations. Note that the object you pass in here ",(0,a.kt)("strong",{parentName:"li"},"must be JSON serializable"),".")),(0,a.kt)("p",null,"When called ",(0,a.kt)("inlineCode",{parentName:"p"},"registerConnection")," will return a promise which resolves if the operation succeeded and gets rejected if it did not."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"nango.registerConnection('slack', 1, 'xoxb-XXXXXXXXXXXXXXXX', { channelId: 'XXXXXXX' })\n.then((result) => {\n    // register succeeded!\n})\n.catch((error) => {\n    // There was a problem whilst registering the connection\n});\n")),(0,a.kt)("p",null,"The result and error variable in the example above are a ",(0,a.kt)("a",{parentName:"p",href:"#nangoMessageHandlerResult"},(0,a.kt)("inlineCode",{parentName:"a"},"NangoMessageHandlerResult")," object"),"."),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Note that connections are unique per user and integration: Attempting to register a connection for the same user id and integration twice will result in an error.")),(0,a.kt)("h2",{id:"triggerAction"},"triggerAction method"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"triggerAction")," method tells the server to execute an action of an integration in the context of a user's connection."),(0,a.kt)("p",null,"It's signature looks like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"public async triggerAction(\n    integration: string,\n    triggerAction: string,\n    userId: string,\n    input: Record<string, unknown>\n): Promise<NangoMessageHandlerResult>\n")),(0,a.kt)("p",null,"Let's look at each parameter:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"integration")," is the name of the integration of which you are triggering the action. This must match 1:1 with the name of the integration in the ",(0,a.kt)("inlineCode",{parentName:"li"},"integrations.yaml")," file"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"triggerAction")," is the name of the action you want to trigger. This must match 1:1 with the action's name in it's action file, e.g. if the filename is ",(0,a.kt)("inlineCode",{parentName:"li"},"notify.action.ts")," you would put ",(0,a.kt)("inlineCode",{parentName:"li"},"notify")," here"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"userId")," is the id of the user for which the action should be called. This must be an id for which a connection was registered for this integration prior to calling ",(0,a.kt)("inlineCode",{parentName:"li"},"triggerAction")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"input")," is any input that should be passed to the action for its execution. Note that the object you pass in here ",(0,a.kt)("strong",{parentName:"li"},"must be JSON serializable"),".")),(0,a.kt)("p",null,"When the promise resolves it does so with a ",(0,a.kt)("a",{parentName:"p",href:"#nangoMessageHandlerResult"},(0,a.kt)("inlineCode",{parentName:"a"},"NangoMessageHandlerResult")," object"),". In case of success, the ",(0,a.kt)("inlineCode",{parentName:"p"},"returnValue")," of this object will be whatever has been ",(0,a.kt)("a",{parentName:"p",href:"/reference/nango-action-reference#inputReturnValues"},"returned by the ",(0,a.kt)("inlineCode",{parentName:"a"},"executeAction")," method"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"// Usual shorthand form\nlet result = await nango.triggerAction('slack', 'notify', 1, { msg: 'Please post this message' });\nconsole.log(`Got this return value from slack.notify: ${result.returnValue}`);\n\n// Or handle the promise manually\nnango.triggerAction('slack', 'notify', 1, { msg: 'Please post this message' })\n.then((result) => {\n    // Success, access the return value at result.returnValue\n})\n.catch((error) => {\n    // Error, learn more by reading error.errorMsg\n});\n")),(0,a.kt)("h2",{id:"close-method"},"close method"),(0,a.kt)("p",null,"When you are done and want your application to exit you should close your nango connection by calling the ",(0,a.kt)("inlineCode",{parentName:"p"},"close")," method."),(0,a.kt)("p",null,"Once called you can no longer send messages to the server."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"nango.close()\n")),(0,a.kt)("p",null,"If you do not call ",(0,a.kt)("inlineCode",{parentName:"p"},"close")," nango will keep an open TCP connection which will prevent your node process from exiting automatically."),(0,a.kt)("h2",{id:"nangoMessageHandlerResult"},"NangoMessageHandlerResult object"),(0,a.kt)("p",null,"All messages sent to the Nango server will return a ",(0,a.kt)("inlineCode",{parentName:"p"},"NangoMessageHandlerResult")," object that contains the result of the message's execution."),(0,a.kt)("p",null,"It's structure looks like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"interface NangoMessageHandlerResult {\n    success: boolean;\n    errorMsg?: string;\n    returnValue?: any;\n}\n")),(0,a.kt)("p",null,"If the operation succeeded ",(0,a.kt)("inlineCode",{parentName:"p"},"success")," is set to ",(0,a.kt)("inlineCode",{parentName:"p"},"true")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"returnValue")," is set to the result of the operation."),(0,a.kt)("p",null,"If the operation failed ",(0,a.kt)("inlineCode",{parentName:"p"},"success")," is set to ",(0,a.kt)("inlineCode",{parentName:"p"},"false")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"errorMsg")," contains a detailed error message describing the problem."))}p.isMDXComponent=!0}}]);